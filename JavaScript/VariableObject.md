## 变量对象
变量对象就是一个名词，别看它又是变量，又是对象的，怪唬人。它就是一个代表变量的对象而已。
它表示定义的变量和函数声明，是执行上下文里重要的一部分。


根据所属上下文不同，变量对象主要有两种类型：
- 全局上下文变量对象
- 函数上下文变量对象

本文主要针对了解函数上下文变量对象

### 全局上下文变量对象
全局上下文变量对象比较容易理解
**全局上下文中的变量对象就是代表全局对象，在客户端中，就是 Window 对象**

### 函数上下文变量对象
在函数上下文中，我们用活动对象（activaton object, AO） 来表示变量对象。

为什么这么做？因为当进入一个执行上下文时，属于这个执行上下文的变量对象会被激活，所以叫做 活动对象。 只有被激活的活动对象上的属性才能被访问。
活动对象跟变量对象其实是一个东西，只是所处状态和环境不同

活动对象是在进入函数上下文时刻被创建的，它通过函数的 arguments 属性初始化。arguments 属性值是 Arguments 对象。


## 执行过程
执行上下文有两个阶段，具体可以看这篇文章 [JS 执行上下文](EC)
1. 创建阶段
2. 执行阶段

### 创建阶段
创建阶段，还没有执行代码
变量对象会包括：
1. 函数的所有形参（如果是函数上下文）
    - 创建一个属性，由名称和对应值组成
    - 没有实参，属性值设为 `undefined`
2. 函数声明
    - 创建一个属性，由名称和对应值组成，值为`函数对象（function-object）`
    - 如果已经存在了同名的属性，则`完全替换`这个属性
3. 变量声明
    - 创建一个属性，由名称和对应值组成，值为 `undefined`
    - 如果变量名称跟已经声明的形式参数或函数相同，则变量声明不会干扰已经存在的这类属性


我们通过一个例子来熟悉一下整个过程：
```js
function foo(a) {
  let b = 2;
  function c() {}
  let d = function () {}

  b = 3;
}

foo(1)
```
在创建阶段，函数foo的 AO 是：
```js
AO = {
  arguments: {
    0: 1,
    length: 1
  }
  a: 1,
  b: undefined,
  c: reference to function c() {},
  d: undefined
}
```

## 参考文章
- [JavaScript深入之变量对象](https://github.com/mqyqingfeng/Blog/issues/5)



[EC]: https://github.com/antipro7/Review_Knowledge/blob/master/JavaScript/ExecutionContext.md
